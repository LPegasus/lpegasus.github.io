(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{81:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return u})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return l}));var o=t(3),r=t(7),a=(t(0),t(90)),u={title:"Hooks API"},c={unversionedId:"hooks/summary",id:"hooks/summary",isDocsHomePage:!1,title:"Hooks API",description:"React Hooks API",source:"@site/docs/hooks/summary.mdx",slug:"/hooks/summary",permalink:"/docs/hooks/summary",editUrl:"https://github.com/LPegasus/tutorial-bytedance-fe/docs/hooks/summary.mdx",version:"current"},s=[{value:"React Hooks API",id:"react-hooks-api",children:[]},{value:"Hooks API \u8d70\u9a6c\u89c2\u82b1",id:"hooks-api-\u8d70\u9a6c\u89c2\u82b1",children:[{value:"useState",id:"usestate",children:[]},{value:"useEffect",id:"useeffect",children:[]},{value:"useContext",id:"usecontext",children:[]},{value:"useLayoutEffect",id:"uselayouteffect",children:[]},{value:"useRef",id:"useref",children:[]},{value:"useMemo | useCallback",id:"usememo--usecallback",children:[]}]},{value:"\u5176\u4ed6\u4e0d\u592a\u91cd\u8981\u7684 API",id:"\u5176\u4ed6\u4e0d\u592a\u91cd\u8981\u7684-api",children:[]}],i={toc:s};function l(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},i,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"react-hooks-api"},"React Hooks API"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"hooks")," API \u662f\u4ece ",Object(a.b)("inlineCode",{parentName:"p"},"React@16.8")," \u5f00\u59cb\u5f15\u5165\u7684\u5168\u65b0\u5f00\u53d1\u6a21\u5f0f\u3002"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"hooks")," \u7684\u51fa\u73b0\u964d\u4f4e\u4e86\u4ee3\u7801\u91cf\uff0c\u63d0\u4f9b\u4e86\u66f4\u7ec6\u7c92\u5ea6\u7684\u903b\u8f91\u62c6\u5206\u548c\u91cd\u7528\u80fd\u529b\uff0c\u4f7f\u903b\u8f91\u590d\u7528\u66f4\u7075\u6d3b\u3002\u4f46\u540c\u65f6\uff0c\u5bf9\u5f00\u53d1\u8005\u63d0\u51fa\u4e86\u66f4\u9ad8\u7684\u8981\u6c42\u3002"),Object(a.b)("h2",{id:"hooks-api-\u8d70\u9a6c\u89c2\u82b1"},"Hooks API \u8d70\u9a6c\u89c2\u82b1"),Object(a.b)("h3",{id:"usestate"},Object(a.b)("a",{parentName:"h3",href:"/docs/hooks/use-state"},"useState")),Object(a.b)("p",null,"\u7ef4\u62a4\u7ec4\u4ef6\u4e0d\u53ef\u53d8\u72b6\u6001"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx",metastring:"live",live:!0},"function Button() {\n  const [count, setCount] = useState(0);\n  return (\n    <button onClick={() => setCount(count + 1)}>Click Count: {count}</button>\n  );\n}\n\nreturn Button;\n")),Object(a.b)("h3",{id:"useeffect"},Object(a.b)("a",{parentName:"h3",href:"/docs/hooks/use-effect"},"useEffect")),Object(a.b)("p",null,"\u7ba1\u7406\u7ec4\u4ef6\u526f\u4f5c\u7528\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7ec4\u4ef6\u6302\u8f7d\u3001\u66f4\u65b0\u3001\u5378\u8f7d\u751f\u547d\u5468\u671f\u65f6\u7684\u56de\u8c03\u3002"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx",metastring:"live",live:!0},"function TimePrinter() {\n  const [visible, setVisible] = useState(false);\n  const [count, setCount] = useState(0);\n  useEffect(() => {\n    // \u5f00\u542f\u8ba1\u65f6\u5668\n    if (visible) {\n      const intervalId = setInterval(() => {\n        setCount((s) => s + 1);\n      }, 1000);\n\n      return () => {\n        // \u5173\u95ed\u8ba1\u65f6\u5668\n        clearInterval(intervalId);\n      };\n    } else {\n      setCount(0);\n    }\n  }, [visible]);\n  return (\n    <div>\n      <button onClick={() => setVisible((s) => !s)}>\n        {visible ? 'hide' : 'show'}\n      </button>\n      <p style={{ opacity: visible ? 1 : 0 }}>{count}</p>\n    </div>\n  );\n}\n\nreturn TimePrinter;\n")),Object(a.b)("h3",{id:"usecontext"},Object(a.b)("a",{parentName:"h3",href:"/docs/hooks/use-context"},"useContext")),Object(a.b)("p",null,"\u83b7\u53d6\u5f53\u524d\u7ec4\u4ef6\u6240\u5904 Context \u4e2d\u7684\u503c"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx",metastring:"live",live:!0},'const PrimaryColorContext = React.createContext(\'#333\');\n\nfunction PrimaryButton(props: React.PropsWithChildren<{}>) {\n  const { children } = props;\n  const color = useContext(PrimaryColorContext);\n  return <button style={{ color }}>{children}</button>;\n}\n\nreturn () => {\n  return (\n    <>\n      <PrimaryButton>Button 1</PrimaryButton>\n      <PrimaryColorContext.Provider value="red">\n        <PrimaryButton>Button 2</PrimaryButton>\n        <PrimaryColorContext.Provider value="blue">\n          <PrimaryButton>Button 3</PrimaryButton>\n        </PrimaryColorContext.Provider>\n        <PrimaryButton>Button 4</PrimaryButton>\n      </PrimaryColorContext.Provider>\n    </>\n  );\n};\n')),Object(a.b)("h3",{id:"uselayouteffect"},"useLayoutEffect"),Object(a.b)("p",null,"\u4e0e useEffect \u4f5c\u7528\u7c7b\u4f3c\uff0c\u4f46\u6267\u884c\u5b9e\u9645\u6bd4 useEffect \u65e9\uff0c\u4f1a\u5728\u6d4f\u89c8\u5668\u5237\u65b0\u9875\u9762\u524d\u6267\u884c\uff0c\u4e0e\u6700\u8fd1\u4e00\u6b21 React \u91cd\u7ed8\u540c\u6b65\u6267\u884c\u3002\nSSR \u65f6\u4f1a\u62a5\u9519\u3002"),Object(a.b)("h3",{id:"useref"},"useRef"),Object(a.b)("p",null,"\u7ef4\u62a4\u7ec4\u4ef6\u7684\u53ef\u53d8\u72b6\u6001\u3001\u83b7\u53d6\u7ec4\u4ef6 reference"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx",metastring:"live",live:!0},"function RefGetDomInstance() {\n  /** \u83b7\u53d6 DOM \u5b9e\u4f8b */\n  const buttonRef = useRef<HTMLButtonElement | null>(null);\n  const [, forceUpdate] = useState();\n\n  useEffect(() => {\n    buttonRef.current.classList.toggle('bg-red');\n  });\n\n  return (\n    <button onClick={forceUpdate} ref={buttonRef}>\n      Click Me!\n    </button>\n  );\n}\n\nreturn RefGetDomInstance;\n")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx",metastring:"live",live:!0},"function RefMutableState() {\n  /** \u7ef4\u62a4\u6570\u636e\u5b9e\u4f8b */\n  const [count, setCount] = useState(0);\n  const mutableStateRef = useRef(count);\n  mutableStateRef.current = count;\n\n  useEffect(() => {\n    /** \u7406\u89e3\u95ed\u5305\u53d8\u91cf */\n    setTimeout(() => {\n      console.log(`mutableState: ${mutableStateRef.current}`);\n      console.log(`count: ${count}`);\n      console.log('');\n    }, 1000);\n  }, [count]);\n\n  return (\n    <button onClick={() => setCount((s) => s + 1)}>\n      Click Count = {count}\n    </button>\n  );\n}\n\nreturn RefMutableState;\n")),Object(a.b)("h3",{id:"usememo--usecallback"},"useMemo | useCallback"),Object(a.b)("p",null,"\u4e00\u822c\u4e0d\u9700\u8981\u4f7f\u7528\uff0c\u505a\u6027\u80fd\u4f18\u5316\u65f6\u4f1a\u7528\u5230\uff0c\u914d\u5408 ",Object(a.b)("inlineCode",{parentName:"p"},"React.memo")," \u51fd\u6570\uff0c\u6765\u51cf\u5c11\u91cd\u7ed8\u8ba1\u7b97\u3002"),Object(a.b)("p",null,"\u5982\u679c\u67d0\u4e2a\u8ba1\u7b97\u6bd4\u8f83\u8017\u65f6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7 useMemo \u6765\u51cf\u5c11\u8ba1\u7b97\u91cf\u3002"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-tsx",metastring:"{3,4} live","{3,4}":!0,live:!0},"interface PropsType {\n  /** \u5bc6\u7801 */\n  pwd: string;\n  /** \u91cd\u590d\u5bc6\u7801 */\n  confirmPwd: string;\n  /** \u53d8\u66f4\u56de\u8c03 */\n  onChange(value: Pick<PropsType, 'pwd' | 'confirmPwd'>): void;\n}\n\nconst MemoizedPwdForm = React.memo((props: PropsType) => {\n  const { pwd, confirmPwd, onChange } = props;\n  const containerRef = useRef();\n\n  useEffect(() => {\n    const form = containerRef.current;\n    if (!form) {\n      return;\n    }\n    const animation = form.animate(\n      [\n        { backgroundColor: 'rgba(50, 25, 200, 0.5)' },\n        { backgroundColor: 'rgba(50, 25, 200, 0)' },\n      ],\n      {\n        duration: 500,\n        iterations: 1,\n      }\n    );\n    return () => animation.cancel();\n  });\n  return (\n    <div\n      style={{\n        display: 'flex',\n        justifyContent: 'flex-start',\n        alignItems: 'center',\n      }}\n      ref={containerRef}\n    >\n      <form action=\"\" style={{ width: '300px' }}>\n        <div className=\"form-item\" autoComplete=\"off\">\n          <input\n            placeholder=\"\u5bc6\u7801\"\n            type=\"password\"\n            value={pwd}\n            autoComplete=\"off\"\n            required={true}\n            onChange={(e) => {\n              onChange({\n                pwd: e.target.value,\n                confirmPwd,\n              });\n            }}\n          />\n        </div>\n        <div className=\"form-item\">\n          <input\n            placeholder=\"\u786e\u8ba4\u5bc6\u7801\"\n            required={true}\n            autoComplete=\"off\"\n            type=\"password\"\n            value={confirmPwd}\n            onChange={(e) => {\n              onChange({\n                pwd,\n                confirmPwd: e.target.value,\n              });\n            }}\n          />\n        </div>\n      </form>\n\n      <h3 style={{ color: '#fff', userSelect: 'none' }}>Re-Render</h3>\n    </div>\n  );\n});\n\nreturn () => {\n  const [, forceUpdate] = useState({});\n  const [formState, setFormState] = useState({\n    pwd: '',\n    confirmPwd: '',\n  });\n\n  const handleChange = useCallback((v) => {\n    setFormState(v);\n  }, []);\n\n  return (\n    <>\n      <button onClick={forceUpdate}>force update</button>\n\n      <MemoizedPwdForm\n        onChange={handleChange}\n        pwd={formState.pwd}\n        confirmPwd={formState.confirmPwd}\n      />\n\n      <div\n        style={{\n          color: 'red',\n          visibility:\n            formState.pwd && formState.pwd === formState.confirmPwd\n              ? 'hidden'\n              : undefined,\n        }}\n      >\n        Invalid\n      </div>\n    </>\n  );\n};\n")),Object(a.b)("h2",{id:"\u5176\u4ed6\u4e0d\u592a\u91cd\u8981\u7684-api"},"\u5176\u4ed6\u4e0d\u592a\u91cd\u8981\u7684 API"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"useImperativeHandle\uff1a\u914d\u5408 ",Object(a.b)("inlineCode",{parentName:"p"},"React.forwardRef"),"\uff0c\u5bf9\u7236\u7ec4\u4ef6\u66b4\u9732\u5185\u90e8\u72b6\u6001\uff0c\u4e00\u822c\u7528\u4e0d\u5230")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"useReducer\uff1a\u57fa\u672c\u7528\u4e0d\u5230\uff0c\u7565\u8fc7")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"useDebugValue\uff1a\u914d\u5408 React DevTools \u4f7f\u7528\uff0c\u6253\u5370\u5185\u90e8\u72b6\u6001\u7528\uff0c\u4e00\u822c\u7528\u4e0d\u5230"))))}l.isMDXComponent=!0}}]);